(window.webpackJsonp=window.webpackJsonp||[]).push([["notificationTray"],{"4nQW":function(e,t,n){"use strict";n.r(t);var i=n("q1tI"),o=n.n(i),r=n("i8i4");n("pNMO"),n("4Brf"),n("0oug"),n("4mDm"),n("DQNa"),n("wLYn"),n("zKZe"),n("uL8W"),n("eoL8"),n("NBAS"),n("ExoC"),n("07d7"),n("SuFq"),n("JfAA"),n("PKPk"),n("3bBZ"),n("R5XZ"),n("17x9");function c(e){var t=e.messengerCount,n=e.showMessenger,i=e.messengerTitle,r=t;return o.a.createElement("div",{id:"messageWall",className:"relative"},o.a.createElement("a",{href:"#",title:i,className:0===r?"inactive inline-block relative mr-4 fa-layers fa-fw fa-3x":"inline-block relative mr-4 fa-layers fa-fw fa-3x",onClick:function(){return n()}},0===r?o.a.createElement("span",{className:"far fa-comment-dots text-gray-500"}):o.a.createElement("span",{className:"fas fa-comment-dots text-yellow-500 hover:text-orange-500 ignore-mouse-down"},o.a.createElement("span",{className:"fa-layers-counter absolute",style:{color:"white",fontSize:"0.8rem",top:"18px",left:"6px"}},r))))}function a(e){var t=e.notificationCount,n=e.showNotifications,i=e.notificationTitle,r=t;return o.a.createElement("div",{id:"notifications"},o.a.createElement("a",{className:0===r?"inactive inline-block relative mr-4 fa-layers fa-fw fa-3x":"inline-block relative mr-4 fa-layers fa-fw fa-3x",title:i,onClick:function(){return n()}},0===r?o.a.createElement("span",{className:"far fa-sticky-note text-gray-500 ignore-mouse-down"}):o.a.createElement("span",{className:"fas fa-sticky-note text-yellow-500 hover:text-orange-500 ignore-mouse-down"},o.a.createElement("span",{className:"fa-layers-counter absolute",style:{color:"white",fontSize:"0.8rem",top:"22px",left:"9px"}},r))))}c.defaultProps={messengerCount:0,messengerTitle:"Message Wall"},a.defaultProps={notificationCount:0,notificationTitle:"Notifications"};var l=n("ohO+"),u=n("J5mc");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(s,e);var t,n,i,r=m(s);function s(e){var t,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=r.call(this,e)).otherProps=f({},e),t.state={notificationCount:0,messengerCount:0,notificationTitle:"Notifications",messengerTitle:"Message Wall"},t.timeout=!0===t.isStaff?1e4:12e4,t.showNotifications=t.showNotifications.bind(y(t)),t.showMessenger=t.showMessenger.bind(y(t)),t.handleLogout=t.handleLogout.bind(y(t)),t.displayTray=!0,t.delay=(n=0,function(e,t){clearTimeout(n),n=setTimeout(e,t)}),t}return t=s,(n=[{key:"componentDidMount",value:function(){this.displayTray&&(this.loadNotification(250+2e3*Math.random()),this.loadMessenger(250+2e3*Math.random()))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.notificationTime),clearTimeout(this.messengerTime)}},{key:"loadNotification",value:function(e){var t=this;this.notificationTime=setTimeout((function(){Object(u.a)("api/notification/refresh/",{method:"GET"},!1).then((function(e){e.count!==t.state.notiificationCount&&t.setState({notificationCount:e.count,notificationTitle:e.title}),e.redirect&&Object(l.a)("/")})),t.loadNotification(t.timeout)}),e)}},{key:"loadMessenger",value:function(e){var t=this;this.messengerTime=setTimeout((function(){Object(u.a)("api/messenger/refresh/",{method:"GET"},!1).then((function(e){e.count!==t.state.messengerCount&&t.setState({messengerCount:e.count,messengerTitle:e.title}),e.redirect&&Object(l.a)("/")})),t.loadMessenger(t.timeout)}),e)}},{key:"showNotifications",value:function(){this.state.notificationCount>0&&Object(l.a)("/notifications/manage/",{method:"GET"},!1)}},{key:"showMessenger",value:function(){this.state.messengerCount>0&&Object(l.a)("/messenger/today/show/",{method:"GET"},!1)}},{key:"handleLogout",value:function(){Object(l.a)("/logout/",{method:"GET"},!1)}},{key:"render",value:function(){return o.a.createElement("div",{className:"flex flex-row-reverse mb-1"},o.a.createElement(c,{messengerCount:this.state.messengerCount,showMessenger:this.showMessenger,title:this.state.messengerTitle}),o.a.createElement(a,{notificationCount:this.state.notificationCount,showNotifications:this.showNotifications,title:this.state.notificationTitle}))}}])&&d(t.prototype,n),i&&d(t,i),s}(i.Component);v.defaultProps={displayTray:!1,locale:!1};var g=document.getElementById("notificationTray");null===g?Object(r.render)(o.a.createElement("div",null,"Â "),document.getElementById("dumpStuff")):Object(r.render)(o.a.createElement(v,null),g)},"7K2e":function(e,t,n){"use strict";function i(e){return void 0===e||(""===e||(null===e||(e===[]||e==={})))}n.d(t,"a",(function(){return i}))},J5mc:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("yq1k"),n("zKZe"),n("07d7"),n("5s+n"),n("rB9j"),n("JTJg"),n("UxlC");var i=n("koSi");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function r(e,t,n){var i={};t&&t.headers&&(i=t.headers,delete t.headers),i=o({},i,{"Content-Type":"application/json; charset=utf-8"}),null===n&&(n="en_GB"),!1!==n&&""!==e||(n="");var r=window.location.protocol+"//"+window.location.hostname+"/";return"/"===e[0]&&(e=e.substring(1)),"http"===e.substring(0,4)&&(r=""),fetch(r+n+e,o({},t,{credentials:"same-origin",headers:i})).then(c).then((function(e){return e.text().then((function(e){return(e=e.replace("<?php","")).includes("window.Sfdump")||e.includes("<?php")?(console.log(e),[]):"string"==typeof e?JSON.parse(e):""}))}))}function c(e){if(e.status>=200&&e.status<400)return e;if(403===e.status){var t=window.location.protocol+"//"+window.location.hostname,n=btoa(e.url);Object(i.o)(t+"/route/"+n+"/error/","_self")}var o=new Error(e.statusText);throw o.response=e,o}},koSi:function(e,t,n){"use strict";n.d(t,"s",(function(){return s})),n.d(t,"i",(function(){return f})),n.d(t,"u",(function(){return d})),n.d(t,"g",(function(){return h})),n.d(t,"o",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return b})),n.d(t,"n",(function(){return v})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return _})),n.d(t,"f",(function(){return j})),n.d(t,"c",(function(){return w})),n.d(t,"e",(function(){return O})),n.d(t,"t",(function(){return k})),n.d(t,"m",(function(){return T})),n.d(t,"h",(function(){return E})),n.d(t,"a",(function(){return N})),n.d(t,"l",(function(){return x})),n.d(t,"d",(function(){return C})),n.d(t,"r",(function(){return S}));n("pNMO"),n("4Brf"),n("0oug"),n("yXV3"),n("4mDm"),n("2B1R"),n("+2oP"),n("pDQq"),n("DQNa"),n("sMBO"),n("zKZe"),n("tkto"),n("07d7"),n("rB9j"),n("JfAA"),n("PKPk"),n("UxlC"),n("3bBZ"),n("R5XZ");var i=n("q1tI"),o=n.n(i),r=n("7K2e"),c=n("ohO+"),a=n("J5mc");function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return void 0===e.children||Object.keys(e.children).map((function(n){var i=e.children[n];s(i,t),Object.keys(i.errors).length>0&&!1!==i.panel&&(void 0===t[i.panel]&&(t[i.panel]={}),t[i.panel].problem=!0)})),t}function f(e,t,n){var i=[];return Object(r.a)(e)||i.push(o.a.createElement("a",{key:"remove",className:"close-button gray ml-3",onClick:function(t){return n.handleAddClick(e.url,"_self")},title:e.prompt},o.a.createElement("span",{className:"fas fa-reply fa-fw text-gray-800 hover:text-indigo-500"}))),Object(r.a)(t)||i.push(o.a.createElement("a",{key:"add",className:"close-button gray ml-3",onClick:function(e){return n.handleAddClick(t.url,"_self")},title:t.prompt},o.a.createElement("span",{className:"fas fa-plus-circle fa-fw text-gray-800 hover:text-indigo-500"}))),i}function d(e,t){return Object(r.a)(e[t])?(console.error("Unable to translate: "+t),t):e[t]}function h(e){var t=e.value,n="/resource/"+btoa(t)+"/"+this.actionRoute+"/download/";void 0!==e.delete_security&&!1!==e.delete_security&&(n="/resource/"+btoa(e.value)+"/"+e.delete_security+"/download/"),Object(c.a)(n,{target:"_blank"},!1)}function m(e,t){void 0===t&&(t="_blank");var n="";"object"===u(e)&&(e=(n=e).url,t=n.target,n=void 0!==n.options?n.options:""),window.open(e,t,n)}function p(e,t){var n={};return t&&(n=s(e[Object.keys(e)[0]],n)),{forms:e,panelErrors:n}}function y(e,t,n){return void 0===n&&(n={},Object.keys(e).map((function(t){var i=e[t];n[i.name]=t}))),e[b(n,t)]}function b(e,t){return e[t.full_name.substring(0,t.full_name.indexOf("["))]}function v(e,t,n){return e[t]=l({},n),l({},e)}function g(e,t){return"object"===u(e.children)?Object.keys(e.children).map((function(n){g(e.children[n],t).id===t.id&&(e.children[n]=t)})):"array"==typeof e.children&&e.children.map((function(n,i){(n=g(n,t)).id===t.id&&(e.children[i]=t)})),e.id===t.id&&(e=t),e}function _(e,t){return"object"===u((e=l({},e)).children)&&(e.children=l({},e.children),Object.keys(e.children).map((function(n){var i=_(e.children[n],t);e.children[n]=i}))),e.name=e.name.replace("__name__",t),e.id=e.id.replace("__name__",t),e.full_name=e.full_name.replace("__name__",t),"string"==typeof e.chained_child&&(e.chained_child=e.chained_child.replace("__name__",t)),"string"==typeof e.label&&(e.label=e.label.replace("__name__",t)),e}function j(e,t){return"object"===u(e.children)&&Object.keys(e.children).map((function(n){j(e.children[n],t).id===t.id&&delete e.children[n]})),"array"==typeof e.children&&e.children.map((function(n,i){(n=j(n,t)).id===t.id&&e.children.splice(i,1)})),e}function w(e,t,n){var i=l({},e);if("object"===u(i.children)&&Object.keys(i.children).length>0){var o=l({},i.children);return Object.keys(o).map((function(e){var i=l({},o[e]);i.id===t.id?(i.value=n,Object.assign(o[e],l({},i))):Object.assign(o[e],w(l({},i),t,n))})),Object.assign(i.children,l({},o)),l({},i)}return l({},i)}function O(e,t){return Object.keys(e).map((function(n){var i=e[n];e[n]=function e(t,n){void 0!==t.children&&Object.keys(t.children).map((function(i){var o=t.children[i];e(o,n),n=k(o,l({},o.visible_keys))}));return t.visible_keys=n,l({},t)}(i,t),t=l({},i.visible_keys)})),e.visible_keys=t,l({},e)}function k(e,t){if("string"==typeof e.visible_by_choice){var n=!1;e.value===e.visible_by_choice&&(n=!0),"toggle"===e.type&&"Y"===e.value&&(n=!0),t[e.id+"_"+e.visible_by_choice]=n}else"object"===u(e.visible_by_choice)?e.visible_by_choice.map((function(n){var i=!1;e.value===n&&(i=!0),t[e.id+"_"+n]=i})):"boolean"==typeof e.visible_by_choice&&!0===e.visible_by_choice&&Object.keys(e.choices).map((function(n){var i=e.choices[n],o=!1;e.value===i.value&&(o=!0),t[e.id+"_"+i.value]=o}));return t}function T(e){var t=!1;return Object.keys(e).map((function(n){e[n]&&(t=!0)})),t}function E(e,t,n){return"string"==typeof n.id&&n.id===t?n:"object"===u(e.children)?(Object.keys(e.children).map((function(i){var o=e.children[i];o.id===t&&(n=o),n=E(e.children[i],t,n)})),n):"array"==typeof e.children?(e.children.map((function(e,i){e.id===t&&(n=e),n=E(e,t,n)})),n):n}function N(e,t){if("expanded_choice"===t.type)return t.value;if("date"===t.type){if(void 0===t.value)t.value=null;else if(console.log(t.value),void 0!==t.value.date)return t.value.date.toString().slice(0,10);return t.value}return"object"===u(t.children)&&Object.keys(t.children).length>0?(Object.keys(t.children).map((function(n){var i=t.children[n];e[i.name]=N({},i)})),e):"array"==typeof t.children&&t.children.length>0?(t.children.map((function(t){e[t.name]=N({},t)})),e):t.value}function x(e,t){null!==e&&e.map((function(e){setTimeout(function e(t,n){Object(a.a)(t.route,{},!1).then((function(i){"success"===i.status&&n(t,i.content),t.timer>0&&setTimeout(e(t,n),t.timer)}))}(e,t),50)}))}function C(e,t){return Object.keys(e).map((function(n){e[n]=function e(t,n,i){void 0!==t.children&&Object.keys(t.children).length>0&&Object.keys(t.children).map((function(o){t.children[o]=e(t.children[o],n,i)}));"choice"===t.type&&void 0!==t.chained_child&&null!==t.chained_child&&(n=S(t,n,i));return l({},t)}(e[n],e,t)})),l({},e)}function S(e,t,n){t=l({},t);var i=l({},y(t,e,n)),o=b(n,e),r=E(i,e.chained_child,{}),c=e.value,a=e.chained_values[c];return("object"!==u(a)||0===Object.keys(a).length&&null!==c)&&(a=e.chained_values[""+c]),"object"!==u(a)||0===Object.keys(a).length?(r.disabled=!0,r.choices={}):(r.disabled=!1,r.choices=l({},a),0===Object.keys(r.choices).length&&(r.disabled=!0)),t=l({},v(t,o,i)),l({},t)}},"ohO+":function(e,t,n){"use strict";function i(e,t,n){var i="_self";t&&"string"==typeof t.target&&(i=t.target);var o="";t&&"string"==typeof t.specs&&(o=t.specs),"boolean"==typeof n&&!1===n&&(n=""),null==n&&(n="en_GB"),""!==n&&(n="/"+n),window.open(window.location.protocol+"//"+window.location.hostname+n+e,i,o)}n.d(t,"a",(function(){return i}))}},[["4nQW","runtime",0,1]]]);